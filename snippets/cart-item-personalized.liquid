{% comment %}
  Cart Item Personalized - Displays personalized products in cart
{% endcomment %}

<div class="cart-item-personalized">
  <div class="cart-item-image">
    {% if item.properties['Mockup Screenshot URL'] %}
      <img 
        src="{{ item.properties['Mockup Screenshot URL'] }}" 
        alt="{{ item.product.title }} - Personalized"
        loading="lazy"
        class="personalized-product-image"
      >
    {% else %}
      <img 
        src="{{ item.image | image_url: width: 120 }}" 
        alt="{{ item.product.title }}"
        loading="lazy"
      >
    {% endif %}
  </div>

  <div class="cart-item-details">
    <h3 class="cart-item-title">{{ item.product.title }}</h3>
    
    {% if item.properties['Mockup Screenshot URL'] %}
      <p class="personalized-label">âœ¨ Personalized Product</p>
    {% endif %}

    <div class="cart-item-variant">
      {% if item.variant.title != 'Default Title' %}
        <p>{{ item.variant.title }}</p>
      {% endif %}
    </div>

    <div class="cart-item-price">
      <span class="price">{{ item.final_line_price | money }}</span>
    </div>

    <div class="cart-item-quantity">
      <label for="quantity-{{ item.key }}">Quantity:</label>
      <input 
        type="number" 
        id="quantity-{{ item.key }}" 
        name="updates[]" 
        value="{{ item.quantity }}" 
        min="0"
        data-item-key="{{ item.key }}"
      >
    </div>

    <!-- Design Download Links -->
    {% if item.properties['Mockup Screenshot URL'] or item.properties['Design File'] %}
      <div class="design-downloads">
        <h4>Design Files:</h4>
        
        {% if item.properties['Mockup Screenshot URL'] %}
          <a 
            href="{{ item.properties['Mockup Screenshot URL'] }}" 
            target="_blank" 
            class="download-link"
            download="mockup-{{ item.product.title | handle }}.png"
          >
            ðŸ“¸ Download Mockup
          </a>
        {% endif %}

        {% if item.properties['Design File'] %}
          <a 
            href="{{ item.properties['Design File'] }}" 
            target="_blank" 
            class="download-link"
            download="design-{{ item.product.title | handle }}.png"
          >
            ðŸŽ¨ Download Design
          </a>
        {% endif %}
      </div>
    {% endif %}

    <button 
      type="button" 
      class="remove-item" 
      data-item-key="{{ item.key }}"
      aria-label="Remove {{ item.product.title }}"
    >
      Remove
    </button>
  </div>
</div>

<style>
  .cart-item-personalized {
    display: flex;
    gap: 1rem;
    padding: 1rem;
    border: 1px solid #ddd;
    border-radius: 8px;
    margin-bottom: 1rem;
  }

  .cart-item-image {
    flex-shrink: 0;
    width: 120px;
    height: 120px;
  }

  .cart-item-image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    border-radius: 4px;
  }

  .personalized-product-image {
    border: 2px solid #007bff;
  }

  .cart-item-details {
    flex: 1;
  }

  .cart-item-title {
    margin: 0 0 0.5rem 0;
    font-size: 1.1rem;
    font-weight: 600;
  }

  .personalized-label {
    color: #007bff;
    font-weight: 600;
    margin: 0 0 0.5rem 0;
    font-size: 0.9rem;
  }

  .cart-item-variant {
    margin-bottom: 0.5rem;
    font-size: 0.9rem;
    color: #666;
  }

  .cart-item-price {
    margin-bottom: 0.5rem;
    font-weight: 600;
  }

  .cart-item-quantity {
    margin-bottom: 1rem;
  }

  .cart-item-quantity label {
    display: block;
    margin-bottom: 0.25rem;
    font-size: 0.9rem;
  }

  .cart-item-quantity input {
    width: 60px;
    padding: 0.25rem;
    border: 1px solid #ddd;
    border-radius: 4px;
  }

  .design-downloads {
    margin-bottom: 1rem;
    padding: 0.75rem;
    background: #f8f9fa;
    border-radius: 4px;
  }

  .design-downloads h4 {
    margin: 0 0 0.5rem 0;
    font-size: 0.9rem;
    color: #333;
  }

  .download-link {
    display: inline-block;
    margin-right: 1rem;
    margin-bottom: 0.5rem;
    padding: 0.5rem 1rem;
    background: #007bff;
    color: white;
    text-decoration: none;
    border-radius: 4px;
    font-size: 0.9rem;
    transition: background 0.3s ease;
  }

  .download-link:hover {
    background: #0056b3;
    color: white;
  }

  .remove-item {
    padding: 0.5rem 1rem;
    background: #dc3545;
    color: white;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    font-size: 0.9rem;
    transition: background 0.3s ease;
  }

  .remove-item:hover {
    background: #c82333;
  }

  @media (max-width: 768px) {
    .cart-item-personalized {
      flex-direction: column;
    }

    .cart-item-image {
      width: 100%;
      height: 200px;
    }

    .download-link {
      display: block;
      margin-right: 0;
      text-align: center;
    }
  }
</style> 